
\documentclass[a4paper,12pt]{article}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{graphicx,hyperref,mathpple,amsmath,exscale,setspace,xcolor}
\usepackage[left=20mm,right=20mm,top=20mm,bottom=20mm]{geometry}
\usepackage{pdflscape,showkeys,changepage}
\usepackage[round]{natbib}

\setcounter{MaxMatrixCols}{10}
%TCIDATA{OutputFilter=LATEX.DLL}
%TCIDATA{Version=5.50.0.2953}
%TCIDATA{<META NAME="SaveForMode" CONTENT="2">}
%TCIDATA{BibliographyScheme=BibTeX}
%TCIDATA{Created=Wednesday, May 03, 2023 13:45:06}
%TCIDATA{LastRevised=Tuesday, November 07, 2023 16:52:11}
%TCIDATA{<META NAME="GraphicsSave" CONTENT="32">}
%TCIDATA{<META NAME="DocumentShell" CONTENT="Standard LaTeX\Blank - Standard LaTeX Article">}
%TCIDATA{CSTFile=40 LaTeX article.cst}

\let\oldref\ref
\AtBeginDocument{
\let\oldref\ref\renewcommand{\ref}[1]{(\oldref{#1})}
\newcommand{\bsq}{\begin{subequations}}\newcommand{\esq}{\end{subequations}}
\newcommand{\bls}{\begin{landscape}}\newcommand{\els}{\end{landscape}}
\renewcommand\showkeyslabelformat[1]{{\parbox[t]{\marginparwidth}{\raggedright\footnotesize\url{#1}}}}
\newcommand{\intxt}[1]{\intertext{#1}}\newcommand{\BAW}[1]{\begin{adjustwidth}{-#1mm}{-5mm}}\newcommand{\EAW}{\end{adjustwidth}}
\newcommand{\vsp}[1]{\vspace*{#1mm}}\newcommand{\hsp}[1]{\hspace*{#1mm}}  }
\makeatletter
\renewcommand*{\@fnsymbol}[1]{\ensuremath{\ifcase#1\or *\or
    \#\or \star\or \bowtie\or \star\star\or \ddagger\ddagger \else\@ctrerr\fi}}
\makeatother
\allowdisplaybreaks
\IfFileExists{C:/swp55/TCITeX/TeX/LaTeX/SWmacros/tcilatex.tex}{\input{tcilatex}}{}
\graphicspath{{../graphics/}{graphics/}}
\newcommand{\dble}{1.77}
\newcommand{\sngl}{1.23}
\definecolor{myred}{rgb}{.50,.10,.10}
\definecolor{mygrn}{rgb}{.10,.35,.10}
\definecolor{myblu}{rgb}{.10,.10,.35}
\hypersetup{colorlinks,citecolor=myblu,filecolor=mygrn,linkcolor=myred,urlcolor=mygrn,breaklinks=true}
\setstretch{\sngl}

\begin{document}


\section{Clark87}

The UC\ model of Clark (1987) is a generalisation of the HP--Filter (a local
linear trend model) that can be expressed as an SSM taking the following
form:\bsq\label{clark0}%
\begin{align}
y_{t}& =y_{t}^{\ast }+\tilde{y}_{t} \\
\Delta y_{t}^{\ast }& =g_{t-1}+\sigma _{1}\varepsilon _{1t} \\
\Delta g_{t}& =\sigma _{2}\varepsilon _{2t} \\
a(L)\tilde{y}_{t}& =\sigma _{3}\varepsilon _{3t},
\end{align}%
\esq where the shocks $\left\{ \varepsilon _{it}\right\} _{i=1}^{3}$ are
assumed to be $i.i.d.$ standard normal and mutually uncorrelated, with
standard deviation $\sigma _{i}$ and $a(L)$ is commonly assumed to be a
stable AR(2), so that $a(L)=(1-a_{1}L-a_{2}L^{2})$. The only observable is $%
y_{t}$ (generally 100 times) the log of real GDP and with the cycle (denoted
by $\tilde{y}_{t}$) now allowed to be serially correlated, following a
stationary AR(2) process. There are 3 shocks in the model.

The `\emph{numbered}' shock to `\emph{named}' shock mapping is:%
\begin{equation}
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t}%
\end{bmatrix}%
=%
\begin{bmatrix}
\varepsilon _{t}^{y^{\ast }} \\ 
\varepsilon _{t}^{g} \\ 
\varepsilon _{t}^{\tilde{y}}%
\end{bmatrix}%
.
\end{equation}

\section{Shock recovery SSM}

\subsection{SSM with lagged states}

Kurz's (2018) SSM has the following general from:\bsq\label{SSM}%
\begin{align}
\mathsf{Measurement}& :\quad Z_{t}=D_{1}X_{t}+D_{2}X_{t-1}+R\varepsilon _{t}
\label{ssm1} \\
\mathsf{State}& :\quad X_{t}=AX_{t-1}+C\varepsilon _{t},  \label{ssm2}
\end{align}%
\esq where $\varepsilon _{t}\sim MN(0,I_{m})$, $D_{1},D_{2},A,R$ are $C$ are
conformable system matrices, $Z_{t}$ the observed variable and $X_{t}$ the
latent state variable.

\subsection{Clark87 SSM\ for shock recovery}

To assess recovery, re-write the model in \ref{clark0} in `\emph{shock
recovery}' State Space Form (SSF). That is, collect all observables in $%
Z_{t} $ and all shocks (and other state variables)\ in $X_{t}$ to yield:%
\begin{align}
\Delta ^{2}y_{t}& =\Delta ^{2}y_{t}^{\ast }+\Delta ^{2}\tilde{y}_{t}  \notag
\label{Z} \\
& =\sigma _{1}\Delta \varepsilon _{1t}+\Delta g_{t-1}+\Delta ^{2}\tilde{y}%
_{t}  \notag \\
& =\sigma _{1}\Delta \varepsilon _{1t}+\sigma _{2}\varepsilon
_{2t-1}+a(L)^{-1}\Delta ^{2}\sigma _{3}\varepsilon _{3t}  \notag \\
\Leftrightarrow a(L)\Delta ^{2}y_{t}& =\sigma _{1}a(L)\Delta \varepsilon
_{1t}+\sigma _{2}a(L)\varepsilon _{2t-1}+\sigma _{3}\Delta ^{2}\varepsilon
_{3t}  \notag \\
Z_{t}& =\sigma _{1}\left[ \varepsilon _{1t}-\left( 2+a_{1}\right)
\varepsilon _{1t-1}+\left( 1+2a_{1}-a_{2}\right) \varepsilon _{1t-2}+\left(
2a_{2}-a_{1}\right) \varepsilon _{1t-3}-a_{2}\varepsilon _{1t-4}\right] 
\notag \\
& \hspace{1pt}+\hspace{1pt}\sigma _{2}(\varepsilon _{2t-1}-a_{1}\varepsilon
_{2t-2}-a_{2}\varepsilon _{2t-3}) \\
& \hspace{1pt}+\hspace{1pt}\sigma _{3}(\varepsilon _{3t}-2\varepsilon
_{3t-1}+\varepsilon _{3t-2}),  \notag
\end{align}%
where I\ have made use of the fact: 
%$Z_{t}=\sigma _{1}[\varepsilon _{1t}-(1+a_{1})\varepsilon
%_{1t-1}-(a_{1}+a_{2})\varepsilon _{1t-2}+a_{2}\varepsilon _{1t-3}]$
%\begin{align*}
%& 1-\left( 2+a_{1}\right) L+\left( 1+2a_{1}-a_{2}\right) L^{2}+\left(
%-a_{1}+2a_{2}\right) L^{3}-a_{2}L^{4} \\
%& \sigma _{1}\left[ \varepsilon _{1t}-\left( 2+a_{1}\right) \varepsilon
%_{1t-1}+\left( 1+2a_{1}-a_{2}\right) \varepsilon _{1t-2}+\left(
%-a_{1}+2a_{2}\right) \varepsilon _{1t-3}-a_{2}\varepsilon _{1t-4}\right]
%\end{align*}
%p == 1 - (2 + a) x + (1 + 2 a - b) x\symbol{94}2 + (-a + 2 b) x\symbol{94}3
%- b x\symbol{94}4
\begin{align}
a(L)\Delta ^{2}& =(1-a_{1}L-a_{2}L^{2})(1-L)^{2}  \notag \\
& =1-\left( 2+a_{1}\right) L+\left( 1+2a_{1}-a_{2}\right) L^{2}+\left(
2a_{2}-a_{1}\right) L^{3}-a_{2}L^{4},  \label{expaL}
\end{align}%
and $Z_{t}=a(L)\Delta ^{2}y_{t}$ is the only observed variable.

The Measurement and State equations corresponding to \ref{Z} are:\BAW{12}\bsq%
\label{K0SSM}%
\begin{align}
\mathsf{Measurement}:\quad Z_{t}& =D_{1}X_{t}+D_{2}X_{t-1}+R\varepsilon _{t}
\notag \\
Z_{t}& =\underbrace{%
\begin{bmatrix}
\sigma _{1} & 0 & \sigma _{3} & -\sigma _{1}\left( 2+a_{1}\right) & \sigma
_{1}\left( 1+2a_{1}-a_{2}\right) & \sigma _{1}\left( 2a_{2}-a_{1}\right) & 0
& 0 & 0%
\end{bmatrix}%
}_{D_{1}}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t} \\ 
\varepsilon _{1t-1} \\ 
\varepsilon _{1t-2} \\ 
\varepsilon _{1t-3} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{2t-2} \\ 
\varepsilon _{3t-1}%
\end{bmatrix}%
}_{X_{t}} \\
& +\underbrace{%
\begin{bmatrix}
0 & \sigma _{2} & -2\sigma _{3} & 0 & 0 & -\sigma _{1}a_{2} & -\sigma
_{2}a_{1} & -\sigma _{2}a_{2} & \sigma _{3}%
\end{bmatrix}%
}_{D_{2}}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t-1} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{3t-1} \\ 
\varepsilon _{1t-2} \\ 
\varepsilon _{1t-3} \\ 
\varepsilon _{1t-4} \\ 
\varepsilon _{2t-2} \\ 
\varepsilon _{2t-3} \\ 
\varepsilon _{3t-2}%
\end{bmatrix}%
}_{X_{t-1}}+\underbrace{%
\begin{bmatrix}
0 & 0 & 0%
\end{bmatrix}%
}_{R}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t}%
\end{bmatrix}%
}_{\varepsilon _{t}} \\
\mathsf{State}:\quad X_{t}& =AX_{t-1}+C\varepsilon _{t},  \notag \\[5mm]
\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t} \\ 
\varepsilon _{1t-1} \\ 
\varepsilon _{1t-2} \\ 
\varepsilon _{1t-3} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{2t-2} \\ 
\varepsilon _{3t-1}%
\end{bmatrix}%
}_{X_{t}}& =\underbrace{%
\begin{bmatrix}
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\ 
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\ 
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0%
\end{bmatrix}%
}_{A}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t-1} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{3t-1} \\ 
\varepsilon _{1t-2} \\ 
\varepsilon _{1t-3} \\ 
\varepsilon _{1t-4} \\ 
\varepsilon _{2t-2} \\ 
\varepsilon _{2t-3} \\ 
\varepsilon _{3t-2}%
\end{bmatrix}%
}_{X_{t-1}}+\underbrace{%
\begin{bmatrix}
1 & 0 & 0 \\ 
0 & 1 & 0 \\ 
0 & 0 & 1 \\ 
0 & 0 & 0 \\ 
0 & 0 & 0 \\ 
0 & 0 & 0 \\ 
0 & 0 & 0 \\ 
0 & 0 & 0 \\ 
0 & 0 & 0%
\end{bmatrix}%
}_{C}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t}%
\end{bmatrix}%
}_{\varepsilon _{t}}.
\end{align}%
\esq\EAW

\section{Alternative formulation}

Try to reduce the state vector $X_{t}$ by using changes for the error terms
that are not required to be expanded. Starting again from:%
\begin{align}
\Delta ^{2}y_{t}& =\Delta ^{2}y_{t}^{\ast }+\Delta ^{2}\tilde{y}_{t} \\
\Delta ^{2}y_{t}^{\ast }& =\sigma _{2}\varepsilon _{2t-1}+\sigma _{1}\Delta
\varepsilon _{1t} \\
\Delta ^{2}\tilde{y}_{t}& =a(L)^{-1}\sigma _{3}\Delta ^{2}\varepsilon _{3t},
\end{align}%
we get (but we do not expand differenced terms of not needed):%
\begin{align}
\Delta ^{2}y_{t}& =\Delta ^{2}y_{t}^{\ast }+\Delta ^{2}\tilde{y}_{t}  \notag
\\
& =\sigma _{2}\varepsilon _{2t-1}+\sigma _{1}\Delta \varepsilon
_{1t}+a(L)^{-1}\sigma _{3}\Delta ^{2}\varepsilon _{3t}  \notag \\
\Leftrightarrow \underbrace{a(L)\Delta ^{2}y_{t}}_{Z_{t}}& =\sigma
_{2}a(L)\varepsilon _{2t-1}+\sigma _{1}a(L)\Delta \varepsilon _{1t}+\sigma
_{3}\Delta ^{2}\varepsilon _{3t}  \notag \\
Z_{t}& =\sigma _{1}a(L)\Delta \varepsilon _{1t}+\sigma _{2}a(L)\varepsilon
_{2t-1}+\sigma _{3}\Delta ^{2}\varepsilon _{3t}  \notag \\
& =\sigma _{1}\Delta \varepsilon _{1t}-a_{1}\sigma _{1}\Delta \varepsilon
_{1t-1}-a_{2}\sigma _{1}\Delta \varepsilon _{1t-2}  \notag \\
& +\sigma _{2}\varepsilon _{2t-1}-a_{1}\sigma _{2}\varepsilon
_{2t-2}-a_{2}\sigma _{2}\varepsilon _{2t-3} \\
& +\sigma _{3}\Delta \varepsilon _{3t}-\sigma _{3}\Delta \varepsilon _{3t-1}
\notag
\end{align}

\begin{align}
\mathsf{Measurement}:\quad Z_{t}& =D_{1}X_{t}+D_{2}X_{t-1}+R\varepsilon _{t}
\notag \\
Z_{t}& =\underbrace{%
\begin{bmatrix}
\sigma _{1} & 0 & 0 & -a_{1}\sigma _{2} & -a_{1}\sigma _{1} & \sigma _{3}%
\end{bmatrix}%
}_{D_{1}}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t} \\ 
\varepsilon _{2t-2} \\ 
\Delta \varepsilon _{1t-1} \\ 
\Delta \varepsilon _{3t}%
\end{bmatrix}%
}_{X_{t}} \\
& +\underbrace{%
\begin{bmatrix}
-\sigma _{1} & \sigma _{2} & 0 & -a_{2}\sigma _{2} & -a_{2}\sigma _{1} & 
-\sigma _{3}%
\end{bmatrix}%
}_{D_{2}}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t-1} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{3t-1} \\ 
\varepsilon _{2t-3} \\ 
\Delta \varepsilon _{1t-2} \\ 
\Delta \varepsilon _{3t-1}%
\end{bmatrix}%
}_{X_{t-1}}+\underbrace{%
\begin{bmatrix}
0 & 0 & 0%
\end{bmatrix}%
}_{R}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t}%
\end{bmatrix}%
}_{\varepsilon _{t}} \\
\mathsf{State}:\quad X_{t}& =AX_{t-1}+C\varepsilon _{t} \\
\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t} \\ 
\varepsilon _{2t-2} \\ 
\Delta \varepsilon _{1t-1} \\ 
\Delta \varepsilon _{3t}%
\end{bmatrix}%
}_{X_{t}}& =\underbrace{%
\begin{bmatrix}
0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & -1 & 0 & 0 & 0%
\end{bmatrix}%
}_{A}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t-1} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{3t-1} \\ 
\varepsilon _{2t-3} \\ 
\Delta \varepsilon _{1t-2} \\ 
\Delta \varepsilon _{3t-1}%
\end{bmatrix}%
}_{X_{t-1}}+\underbrace{%
\begin{bmatrix}
1 & 0 & 0 \\ 
0 & 1 & 0 \\ 
0 & 0 & 1 \\ 
0 & 0 & 0 \\ 
0 & 0 & 0 \\ 
0 & 0 & 1%
\end{bmatrix}%
}_{C}\underbrace{%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t}%
\end{bmatrix}%
}_{\varepsilon _{t}}.
\end{align}%
\bigskip 

\bigskip $\varepsilon _{1t-1}-\varepsilon _{1t-2}$

\bigskip $%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t} \\ 
\varepsilon _{2t-2} \\ 
\varepsilon _{1t-1} \\ 
\varepsilon _{1t-2} \\ 
\Delta \varepsilon _{3t}%
\end{bmatrix}%
=%
\begin{bmatrix}
0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 1 & 0 & 0 & -1 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & -1 & 0 & 0 & 0 & 0%
\end{bmatrix}%
\begin{bmatrix}
\varepsilon _{1t-1} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{3t-1} \\ 
\varepsilon _{2t-3} \\ 
\varepsilon _{1t-2} \\ 
\varepsilon _{1t-3} \\ 
\Delta \varepsilon _{3t-1}%
\end{bmatrix}%
+%
\begin{bmatrix}
1 & 0 & 0 \\ 
0 & 1 & 0 \\ 
0 & 0 & 1 \\ 
0 & 0 & 0 \\ 
0 & 0 & 0 \\ 
0 & 0 & 1 \\ 
0 & 0 & 1%
\end{bmatrix}%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t}%
\end{bmatrix}%
\allowbreak $

\bigskip 

\bigskip $\varepsilon _{1t-1}-\varepsilon _{1t-2}$

\bigskip $-\varepsilon _{t-2}$

\bigskip 

\bigskip 

\bigskip 

\bigskip 

\BAW{12}

This is correct now:

$%
\begin{bmatrix}
\sigma _{1} & 0 & 0 & -a_{1}\sigma _{2} & -a_{1}\sigma _{1} & \sigma _{3}%
\end{bmatrix}%
\begin{bmatrix}
\varepsilon _{1t} \\ 
\varepsilon _{2t} \\ 
\varepsilon _{3t} \\ 
\varepsilon _{2t-2} \\ 
\Delta \varepsilon _{1t-1} \\ 
\Delta \varepsilon _{3t}%
\end{bmatrix}%
+%
\begin{bmatrix}
-\sigma _{1} & \sigma _{2} & 0 & -a_{2}\sigma _{2} & -a_{2}\sigma _{1} & 
-\sigma _{3}%
\end{bmatrix}%
\begin{bmatrix}
\varepsilon _{1t-1} \\ 
\varepsilon _{2t-1} \\ 
\varepsilon _{3t-1} \\ 
\varepsilon _{2t-3} \\ 
\Delta \varepsilon _{1t-2} \\ 
\Delta \varepsilon _{3t-1}%
\end{bmatrix}%
=\allowbreak \sigma _{2}\varepsilon _{2t-1}-\sigma _{1}\varepsilon
_{t-1}+\sigma _{1}\varepsilon _{t}+\Delta \sigma _{3}\varepsilon
_{3t}-\Delta \sigma _{3}\varepsilon _{3t-1}-\sigma _{2}a_{1}\varepsilon
_{2t-2}-\sigma _{2}a_{2}\varepsilon _{2t-3}-\Delta \sigma
_{1}a_{1}\varepsilon _{t-1}-\Delta \sigma _{1}a_{2}\varepsilon
_{t-2}\allowbreak $

\EAW

\bigskip 

\end{document}
